javascript:'use strict';var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h['return']&&h['return']()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a};function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}(function(){var a=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return fetch('https://app.asana.com/api/1.0'+a,_extends({},b,{headers:_extends({},b.headers,{Authorization:'Bearer '+'<auth-token-here>'})})).then(function(a){return a.json()}).then(function(a){return a.data})},b=function(){return a('/projects/'+window.location.href.split('/')[4]+'/sections')},c=function(b){return a('/sections/'+b+'/tasks')},d=function(b){var c=b.id;return a('/tasks/'+c+'/stories')},e=function(a){return a.reduce(function(a,b){var c=b.name,d=b.id;return _extends({},a,_defineProperty({},c.toLowerCase(),d))},{})},f=function(a){return new Promise(function(b){var c=prompt('Enter section name').toLowerCase();b({id:a[c],label:c})})},g=function(){return new Promise(function(a){a(prompt('Enter threshold days'))})},h=function(a){return function(b,c,d){return'added'===b.type?(b.from=null,b.to=d[c+1]?'moved'===d[c+1].type?d[c+1].from:'unknown':a):'removed'===b.type&&(b.to=null,b.from='added'===d[c-1].type?'unknown':d[c-1].to),b}},i=function(a,b){return function(c){return c.filter(function(a){var b=a.type;return'system'===b}).reduce(function(b,c){if(c.text==='added to '+a)return b.concat({type:'added',date:c.created_at});if(c.text==='removed from '+a)return b.concat({type:'removed',date:c.created_at});if(c.text.startsWith('moved this Task from')){var i=/^moved this Task from (.+) to (.+?)(?:(?: in )(.*))?$/.exec(c.text);if(!i)return b;var d=_slicedToArray(i,4),e=d[0],f=d[1],g=d[2],h=d[3];if(h===a||!h)return b.concat({type:'moved',date:c.created_at,from:f,to:g})}return b},[]).map(h(b)).reverse().find(function(a){return a.to.toLowerCase()===b})}},j={fontSize:'11px',display:'inline-flex',alignItems:'flex-end',marginLeft:'0.3em',color:'#000'},k=function(a,b,c){console.log('here');var d=document.querySelectorAll('.BoardColumn.BoardBody-column.BoardBody-columnInBoardWithViewMenu'),e=[].concat(_toConsumableArray(d)).find(function(b){return b.querySelector('.BoardColumnHeaderTitle').innerText.toLowerCase()===a}),f=e.querySelectorAll('.BoardCardWithCustomProperties.BoardColumnCardsContainer-item');[].concat(_toConsumableArray(f)).map(function(a){var b=c.find(function(b){return b.name===a.querySelector('.BoardCardWithCustomProperties-name').innerText});return{task:b,card:a}}).filter(function(a){return a.task}).forEach(l(b))},l=function(a){return function(b){var c=b.card,d=b.task;d.days>=a&&(c.style.backgroundColor='red');var e=document.createElement('div');e.innerText=0<d.days?d.days+' days':'today',e.classList.add('days-display'),Object.keys(j).forEach(function(a){return e.style[a]=j[a]}),c.querySelector('.days-display')||c.querySelector('.BoardCardWithCustomProperties-metadata').appendChild(e)}},m=function(a){return function(b){return b.map(function(b,c){return _extends({},a[c],{days:Math.floor((new Date-new Date(b.date))/86400000)})})}},n=function(a,b){return function(c){return Promise.all(c.map(d)).then(function(c){return c.map(i(a,b))}).then(m(c)).then(function(a){return g().then(function(c){return k(b,c,a)})})}},o=function(a){return function(b){var d=b.label,e=b.id;return c(e).then(n(a,d))}};a('/projects/'+window.location.href.split('/')[4]).then(function(a){var c=a.name;return b().then(e).then(f).then(o(c))})})();